<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Article | Defense Technology</title>
    <meta name="description" content="Defense technology article">
    <link rel="stylesheet" href="css/style.css">
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Markdown parser -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Netlify Identity Widget -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-container">
            <a href="index.html" class="logo">Defense<span>Tech</span></a>
            <button class="hamburger" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li class="dropdown">
                        <a href="#">Systems <i class="fas fa-chevron-down"></i></a>
                        <div class="dropdown-content">
                            <a href="pages/land.html">Land Systems</a>
                            <a href="pages/naval.html">Naval Systems</a>
                            <a href="pages/air.html">Air Systems</a>
                            <a href="pages/space-cyber.html">Space & Cyber</a>
                        </div>
                    </li>
                    <li><a href="pages/future.html">Future Tech</a></li>
                    <li><a href="pages/about.html">About</a></li>
                    <li><a href="articles.html">Articles</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Article Content Section -->
    <section class="article-content">
        <div class="container">
            <div class="article-header">
                <div id="article-category" class="article-category">Category</div>
                <h1 id="article-title">Article Title</h1>
                <div class="article-meta">
                    <span id="article-date">Publication Date</span>
                    <div id="article-tags" class="article-tags">
                        <!-- Tags will be added here dynamically -->
                    </div>
                </div>
                <div id="article-image" class="article-featured-image">
                    <img src="assets/images/placeholder-article.jpg" alt="Article featured image">
                </div>
            </div>
            
            <div id="article-body" class="article-body">
                <!-- Article content will be loaded here -->
                <div class="loading">
                    <i class="fas fa-spinner fa-spin"></i> Loading article...
                </div>
            </div>
            
            <div class="article-footer">
                <div class="article-share">
                    <h3>Share this article</h3>
                    <div class="share-buttons">
                        <a href="#" class="share-button" id="share-twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="share-button" id="share-facebook"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="share-button" id="share-linkedin"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" class="share-button" id="share-email"><i class="fas fa-envelope"></i></a>
                    </div>
                </div>
                
                <div class="article-author">
                    <h3>About the Author</h3>
                    <p>Articles on Defense Technology are written by experts in military systems and technologies, providing accurate and insightful analysis of developments in the defense sector.</p>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Related Articles Section -->
    <section class="related-articles bg-light">
        <div class="container">
            <div class="section-title">
                <h2>Related Articles</h2>
            </div>
            <div class="card-grid" id="related-articles">
                <!-- Related articles will be loaded here dynamically -->
                <div class="card article-card">
                    <div class="card-img">
                        <img src="assets/images/placeholder-article.jpg" alt="Related article thumbnail">
                    </div>
                    <div class="card-content">
                        <span class="article-category">Category</span>
                        <h3 class="card-title">Related Article Title</h3>
                        <p class="article-date">Publication Date</p>
                        <p>Brief description of the related article.</p>
                        <a href="#" class="btn">Read More</a>
                    </div>
                </div>
                
                <div class="card article-card">
                    <div class="card-img">
                        <img src="assets/images/placeholder-article.jpg" alt="Related article thumbnail">
                    </div>
                    <div class="card-content">
                        <span class="article-category">Category</span>
                        <h3 class="card-title">Related Article Title</h3>
                        <p class="article-date">Publication Date</p>
                        <p>Brief description of the related article.</p>
                        <a href="#" class="btn">Read More</a>
                    </div>
                </div>
                
                <div class="card article-card">
                    <div class="card-img">
                        <img src="assets/images/placeholder-article.jpg" alt="Related article thumbnail">
                    </div>
                    <div class="card-content">
                        <span class="article-category">Category</span>
                        <h3 class="card-title">Related Article Title</h3>
                        <p class="article-date">Publication Date</p>
                        <p>Brief description of the related article.</p>
                        <a href="#" class="btn">Read More</a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Comments Section -->
    <section id="comments-section" class="comments-section">
        <div class="container">
            <div class="section-title">
                <h2>Comments</h2>
            </div>
            <div id="disqus_thread"></div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Defense<span>Tech</span></h3>
                    <p>Exploring modern military technology and defense systems across all domains.</p>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul class="footer-links">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="pages/land.html">Land Systems</a></li>
                        <li><a href="pages/naval.html">Naval Systems</a></li>
                        <li><a href="pages/air.html">Air Systems</a></li>
                        <li><a href="pages/space-cyber.html">Space & Cyber</a></li>
                        <li><a href="pages/future.html">Future Tech</a></li>
                        <li><a href="pages/about.html">About</a></li>
                        <li><a href="articles.html">Articles</a></li>
                        <li><a href="admin/">Admin Login</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Disclaimer</h3>
                    <p>This website is for educational purposes only. All information is publicly available and not classified.</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 DefenseTech. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/main.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Get the article slug from the URL
            const urlPath = window.location.pathname;
            const articleSlug = urlPath.split('/').pop().replace('.html', '');
            
            // Function to load article content
            async function loadArticle() {
                try {
                    // Fetch the article markdown file
                    const response = await fetch(`/articles/${articleSlug}.md`);
                    
                    if (!response.ok) {
                        throw new Error('Article not found');
                    }
                    
                    const markdown = await response.text();
                    
                    // Parse frontmatter (metadata at the top of the markdown file)
                    const frontmatterRegex = /^---\s*\n([\s\S]*?)\n---\s*\n([\s\S]*)$/;
                    const match = markdown.match(frontmatterRegex);
                    
                    if (!match) {
                        throw new Error('Invalid article format');
                    }
                    
                    const frontmatter = match[1];
                    const content = match[2];
                    
                    // Parse frontmatter
                    const metadata = {};
                    frontmatter.split('\n').forEach(line => {
                        const parts = line.split(':');
                        if (parts.length >= 2) {
                            const key = parts[0].trim();
                            const value = parts.slice(1).join(':').trim();
                            
                            // Handle special cases like arrays (tags)
                            if (key === 'tags' && value.startsWith('[') && value.endsWith(']')) {
                                metadata[key] = value.slice(1, -1).split(',').map(tag => tag.trim());
                            } else {
                                metadata[key] = value.replace(/^['"](.*)['"]$/, '$1'); // Remove quotes if present
                            }
                        }
                    });
                    
                    // Update page title
                    document.title = `${metadata.title || 'Article'} | Defense Technology`;
                    
                    // Update article metadata in the DOM
                    document.getElementById('article-title').textContent = metadata.title || 'Untitled Article';
                    document.getElementById('article-category').textContent = metadata.category || 'Uncategorized';
                    document.getElementById('article-date').textContent = formatDate(metadata.date);
                    
                    // Update tags
                    const tagsContainer = document.getElementById('article-tags');
                    tagsContainer.innerHTML = '';
                    if (metadata.tags && Array.isArray(metadata.tags)) {
                        metadata.tags.forEach(tag => {
                            const tagElement = document.createElement('span');
                            tagElement.className = 'tag';
                            tagElement.textContent = tag;
                            tagsContainer.appendChild(tagElement);
                        });
                    }
                    
                    // Update featured image if available
                    if (metadata.thumbnail) {
                        const imgElement = document.querySelector('#article-image img');
                        imgElement.src = metadata.thumbnail;
                        imgElement.alt = metadata.title || 'Article image';
                    }
                    
                    // Render markdown content
                    const articleBody = document.getElementById('article-body');
                    articleBody.innerHTML = marked.parse(content);
                    
                    // Setup share buttons
                    setupShareButtons(metadata.title);
                    
                    // Load Disqus comments if enabled
                    if (metadata.comments !== 'false') {
                        loadDisqusComments(articleSlug);
                    } else {
                        document.getElementById('comments-section').style.display = 'none';
                    }
                    
                } catch (error) {
                    console.error('Error loading article:', error);
                    document.getElementById('article-body').innerHTML = `
                        <div class="error-message">
                            <h2>Article Not Found</h2>
                            <p>Sorry, we couldn't find the article you're looking for.</p>
                            <p><a href="articles.html">Browse all articles</a></p>
                        </div>
                    `;
                }
            }
            
            // Format date for display
            function formatDate(dateString) {
                if (!dateString) return 'Unknown date';
                
                try {
                    const date = new Date(dateString);
                    return date.toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                } catch (e) {
                    return dateString; // Return as-is if parsing fails
                }
            }
            
            // Setup share buttons
            function setupShareButtons(title) {
                const pageUrl = encodeURIComponent(window.location.href);
                const pageTitle = encodeURIComponent(title || 'Defense Technology Article');
                
                document.getElementById('share-twitter').href = `https://twitter.com/intent/tweet?url=${pageUrl}&text=${pageTitle}`;
                document.getElementById('share-facebook').href = `https://www.facebook.com/sharer/sharer.php?u=${pageUrl}`;
                document.getElementById('share-linkedin').href = `https://www.linkedin.com/shareArticle?mini=true&url=${pageUrl}&title=${pageTitle}`;
                document.getElementById('share-email').href = `mailto:?subject=${pageTitle}&body=Check out this article: ${pageUrl}`;
            }
            
            // Load Disqus comments
            function loadDisqusComments(identifier) {
                window.disqus_config = function() {
                    this.page.url = window.location.href;
                    this.page.identifier = identifier;
                };
                
                const d = document, s = d.createElement('script');
                s.src = 'https://defense-tech.disqus.com/embed.js'; // Replace with your Disqus shortname
                s.setAttribute('data-timestamp', +new Date());
                (d.head || d.body).appendChild(s);
            }
            
            // Load the article
            loadArticle();
        });
    </script>
    <!-- Netlify Identity Widget Script -->
    <script>
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/admin/";
                    });
                }
            });
        }
    </script>
</body>
</html>
